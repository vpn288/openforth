Когда ENCLOSE доходит до конца буфера, проверяем кончился ли файл. Если кончился, то делаем EXIT. 
Иначе - подкачиваем очередную порцию.

Доходим до конца буфера на скипе разделителей:
	inc rdi
_skip_delimeters:
	sub qword [bytes_to_read],1 ; [nkey],1
	jb _word2
	lodsb
	inc qword [_in_value]
	cmp al,20h
	jbe _skip_delimeters
_word3:
	stosb
	inc rdx
	sub qword [bytes_to_read],1 ; [nkey],1
	jb _word4
	lodsb
	inc qword [_in_value]
	cmp al,20h
	jnbe _word3
_word4:
; string to validate
	 mov [rbx],dl
	 ret
_word2:
;end of buffer
;load next portion
;а нет. тут засада. файл-то закрыт. по-хорошему его надо закрывать когда он скачается весь.
	mov rax,[handle]
	call _Push
        call _rdfile

; empty string
	 mov	rax,5449584504h ;4,"EXIT"
	 mov qword [rbx],rax
	 ;mov dword [ebx+4],054h ;"T",0
	 ret
